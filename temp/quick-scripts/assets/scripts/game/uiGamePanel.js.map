{"version":3,"sources":["uiGamePanel.js"],"names":["mvs","require","uiPanel","cc","Class","extends","properties","voteNode","Node","voteTitle","voteRes","someTip","complete","gameRes","playerlists1","default","type","Sprite","playerlists2","onLoad","Game","GameEnv","_super","players","votedPlayers","outPlayers","attentionPlayers","canVote","voteNums","p1","p2","p3","p4","p5","clientEvent","on","eventType","roundStart","gameOver","leaveRoomMedNotify","leaveRoom","roundVote","voteStart","endVote","voteEnd","writeVote","i","GLB","playerUserIds","length","temp","instantiate","nodeDict","active","parent","gameUserInfo","getComponent","init","setData","setNum","push","myNum","userInfo","id","mySName","showVoteResult","userName","isOut","index","a","node","getChildByName","voteNail","children","Label","string","console","log","setOut","userIcon","spriteFrame","parseInt","closeVote","forEach","pl","includes","number","nextPlayerTurn","checkProcess","isRoomOwner","BlockManager","checkNeed","engine","sendEventEx","JSON","stringify","action","NEED_UP","playerId","data","playerNum","resetVote","self","removeAllChildren","userId","vote","someOneInfo","uiFunc","openUI","obj","uiTip","bind","VOTE_ONE","Button","enabled","outs","attentions","checkResult","playerSum","res","Object","keys","sort","b","votes","exit","GameManager","gameState","GameState","Over","good","bad","ProgressBar","progress","end","director","loadScene","currentPlayer","cd","setTimeout","Play","player","setNormal","nowPlayer","setBig","onDestroy","off"],"mappings":"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","file":"uiGamePanel.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\game","sourcesContent":["var mvs = require(\"Matchvs\");\r\nvar uiPanel = require(\"uiPanel\");\r\n\r\n\r\ncc.Class({\r\n    extends: uiPanel,\r\n\r\n    properties: {\r\n        voteNode: cc.Node,\r\n        voteTitle: cc.Node,\r\n        voteRes: cc.Node,\r\n        someTip: cc.Node, //点击可疑玩家\r\n        complete: cc.Node,//完成度\r\n        gameRes:cc.Node,//游戏结果\r\n        playerlists1: {\r\n            default: [],\r\n            type: cc.Sprite\r\n        },\r\n        playerlists2: {\r\n            default: [],\r\n            type: cc.Sprite\r\n        },\r\n    },\r\n    onLoad() {\r\n        Game.GameEnv = this;\r\n\r\n        this._super();\r\n        this.players = [];\r\n        this.votedPlayers = [];\r\n        this.outPlayers = [];\r\n        this.attentionPlayers = [];\r\n        this.canVote = true;\r\n        this.voteNums = { p1: 0, p2: 0, p3: 0, p4: 0, p5: 0 };\r\n\r\n        clientEvent.on(clientEvent.eventType.roundStart, this.roundStart, this);\r\n        clientEvent.on(clientEvent.eventType.gameOver, this.gameOver, this);\r\n        clientEvent.on(clientEvent.eventType.leaveRoomMedNotify, this.leaveRoom, this);\r\n        clientEvent.on(clientEvent.eventType.roundVote, this.voteStart, this);\r\n        clientEvent.on(clientEvent.eventType.endVote, this.voteEnd, this);\r\n        clientEvent.on(clientEvent.eventType.writeVote, this.writeVote, this);\r\n\r\n\r\n        for (var i = 0; i < GLB.playerUserIds.length; i++) {\r\n            var temp = cc.instantiate(this.nodeDict[\"playerPrefab\"]);\r\n            temp.active = true;\r\n            temp.parent = this.nodeDict[\"player\"];\r\n            var gameUserInfo = temp.getComponent('gameUserInfo');\r\n            gameUserInfo.init();\r\n            gameUserInfo.setData(GLB.playerUserIds[i]);\r\n            gameUserInfo.setNum('p' + (i + 1));\r\n            this.players.push(gameUserInfo);\r\n        }\r\n\r\n\r\n        //判断自己的序号\r\n        var myNum =0;\r\n        for(var i =1;i<=GLB.playerUserIds.length;i++){\r\n            if(GLB.playerUserIds[i-1] == GLB.userInfo.id){\r\n                myNum = i;\r\n                break;\r\n            }\r\n        }\r\n        GLB.mySName = \"p\" + myNum; \r\n    },\r\n    showVoteResult(userName, isOut, index) {\r\n        this.voteTitle.active = false;\r\n        this.someTip.active = false;\r\n        this.voteRes.active = true;\r\n        this.nodeDict[\"player\"].active = true;\r\n        for (let i = 0; i < this.players.length; i++) {\r\n            var a = (\"p\" + (i + 1));\r\n            this.players[i].node.getChildByName(\"nail\").active = true;\r\n            this.players[i].node.getChildByName(\"nail\").getComponent(\"nailPlay\").voteNail(this.voteNums[a]);\r\n        }\r\n        if (isOut) {\r\n            this.voteRes.children[0].active = true;\r\n            this.nodeDict[\"userName\"].getComponent(cc.Label).string = userName;\r\n\r\n            //var target = this.players[index - 1].node;\r\n            var a = \"p\" + index;\r\n            console.log(\"a \" + a);\r\n            this.players[index - 1].setOut();\r\n            this.nodeDict[\"outPrefab\"].active = true;\r\n            this.nodeDict[\"outPrefab\"].getComponent(\"gameUserInfo\").userIcon.spriteFrame = this.players[index - 1].userIcon.spriteFrame;\r\n            this.nodeDict[\"outPrefab\"].getChildByName(\"nail\").active = true;\r\n            this.nodeDict[\"outPrefab\"].getChildByName(\"nail\").getComponent(\"nailPlay\").voteNail(parseInt(this.voteNums[a]));\r\n            //createjs.Tween.get(target).to({ height: 130 }, 300);\r\n            // createjs.Tween.get(target).to({ width: 130 }, 300).call(()=>{\r\n            //     target.parent = this.nodeDict[\"outPosition\"].parent;\r\n            //     createjs.Tween.get(target).to({ x: this.nodeDict[\"outPosition\"].x }, 500);\r\n            //     createjs.Tween.get(target).to({ y: this.nodeDict[\"outPosition\"].y }, 500);\r\n            // });\r\n\r\n        } else {\r\n            this.voteRes.children[1].active = true;\r\n        }\r\n\r\n\r\n    },\r\n    closeVote() {\r\n        this.voteTitle.active = true;\r\n        this.someTip.active = true;\r\n        this.voteRes.active = false;\r\n        this.voteRes.children[0].active = false;\r\n        this.voteRes.children[1].active = false;\r\n        this.nodeDict[\"userName\"].getComponent(cc.Label).string = \"\";\r\n        this.voteNode.active = false;\r\n        this.nodeDict[\"player\"].active = true;\r\n\r\n        this.players.forEach(pl => {\r\n            pl.node.getChildByName(\"nail\").active = false;\r\n            this.nodeDict[\"outPrefab\"].getChildByName(\"nail\").active = false;\r\n            this.nodeDict[\"outPrefab\"].active = false;\r\n            if (this.outPlayers.includes(pl.number)) {\r\n                pl.setOut();\r\n            }\r\n        });\r\n\r\n    },\r\n    nextPlayerTurn() {\r\n\r\n        this.complete.getComponent(\"bar_cosine\").checkProcess();\r\n\r\n        \r\n\r\n        if(this.outPlayers.includes(GLB.mySName)){\r\n            return;\r\n        }\r\n\r\n        if (GLB.isRoomOwner) {\r\n            Game.BlockManager.checkNeed(GLB.userInfo.id);\r\n\r\n        } else {\r\n            mvs.engine.sendEventEx(0, JSON.stringify(\r\n                {\r\n                    action: GLB.NEED_UP,\r\n                    playerId: GLB.userInfo.id\r\n                }\r\n            ), 0, [GLB.playerUserIds[0]]);\r\n        }\r\n\r\n\r\n    },\r\n\r\n    writeVote(data) {\r\n        let playerNum = 0;\r\n        for (let i = 1; i <= GLB.playerUserIds.length; i++) {\r\n            if (GLB.playerUserIds[i - 1] == data) {\r\n                playerNum = i;\r\n                break;\r\n            }\r\n        }\r\n        if (playerNum > 0) {\r\n            let a = \"p\" + playerNum;\r\n            this.voteNums[a] += 1;\r\n\r\n        }\r\n    },\r\n\r\n\r\n\r\n    resetVote() {\r\n        this.voteNums = { p1: 0, p2: 0, p3: 0, p4: 0, p5: 0 };\r\n    },\r\n\r\n    voteStart() {\r\n        let self = this;\r\n        this.nodeDict[\"player\"].active = false;\r\n        if (this.voteNode.active === false && this.canVote) {\r\n            this.resetVote();\r\n            this.canVote = false;\r\n            this.voteNode.active = true;\r\n            this.nodeDict[\"vote\"].active = true;\r\n            this.nodeDict[\"voteLayout\"].removeAllChildren(true);\r\n            for (let i = 0; i < this.players.length; i++) {\r\n                if (this.players[i].userId == GLB.userInfo.id) {\r\n                    continue;\r\n                }\r\n                if (!this.outPlayers.includes(this.players[i].number)) {\r\n                    var temp = cc.instantiate(this.nodeDict[\"votePrefab\"]);\r\n                    temp.active = true;\r\n                    temp.parent = this.nodeDict[\"voteLayout\"];\r\n                    var gameUserInfo = temp.getComponent('gameUserInfo');\r\n                    gameUserInfo.init();\r\n                    gameUserInfo.setData(this.players[i].userId);\r\n                    gameUserInfo.setNum(this.players[i].number);\r\n                    self.votedPlayers.push(temp);\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n    },\r\n    vote(someOneInfo) {\r\n\r\n        if(this.outPlayers.includes(GLB.mySName)){\r\n            uiFunc.openUI(\"uiTip\", function (obj) {\r\n                var uiTip = obj.getComponent(\"uiTip\");\r\n                if (uiTip) {\r\n                    uiTip.setData(\"你已经被淘汰，不能参与投票哦\");\r\n                }\r\n            }.bind(this));\r\n            return;\r\n        }\r\n\r\n\r\n\r\n        uiFunc.openUI(\"uiTip\", function (obj) {\r\n            var uiTip = obj.getComponent(\"uiTip\");\r\n            if (uiTip) {\r\n                uiTip.setData(\"你怀疑了\" + someOneInfo.userName + \"玩家\");\r\n            }\r\n        }.bind(this));\r\n\r\n        if (GLB.isRoomOwner) {\r\n            this.writeVote(someOneInfo.userId);\r\n\r\n        } else {\r\n            mvs.engine.sendEventEx(0, JSON.stringify(\r\n                {\r\n                    action: GLB.VOTE_ONE,\r\n                    playerId: someOneInfo.userId\r\n                }\r\n            ), 0, [GLB.playerUserIds[0]]);\r\n\r\n        }\r\n\r\n\r\n        this.votedPlayers.forEach(pl => {\r\n            pl.getComponent(cc.Button).enabled = false;\r\n        });\r\n    },\r\n    voteEnd(outs, attentions) {\r\n        if (this.canVote) {\r\n            return;\r\n        }\r\n        this.canVote = true;\r\n        if (!GLB.isRoomOwner) {\r\n            this.outPlayers = outs;\r\n            this.attentionPlayers = attentions;\r\n        }\r\n        this.nodeDict[\"vote\"].active = false;\r\n        this.votedPlayers = [];\r\n\r\n        if (this.attentionPlayers.length == 0) {\r\n            let index = parseInt(this.outPlayers[this.outPlayers.length - 1][1]);\r\n\r\n            this.showVoteResult(this.players[index - 1].userName, true, index);\r\n        } else {\r\n            this.showVoteResult(\"\", false);\r\n        }\r\n\r\n\r\n\r\n    },\r\n\r\n    checkResult() {\r\n\r\n        let temp = this.voteNums;\r\n        let playerSum = this.players.length;\r\n        let res = Object.keys(temp).sort(function (a, b) { return temp[a] - temp[b]; });\r\n\r\n        if (temp[res[playerSum - 1]] > temp[res[playerSum - 2]]) {\r\n\r\n            this.outPlayers.push(res[playerSum - 1]);\r\n            this.attentionPlayers = [];\r\n\r\n\r\n\r\n\r\n        } else {\r\n            this.attentionPlayers = [];\r\n            let votes = temp[res[playerSum - 1]];\r\n            this.attentionPlayers.push(res[playerSum - 1]);\r\n            for (let i = playerSum - 2; i >= 0; i--) {\r\n                if (temp[res[i]] < votes) {\r\n                    break;\r\n                } else {\r\n                    this.attentionPlayers.push(res[i]);\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n\r\n    },\r\n\r\n\r\n\r\n    exit() {\r\n        uiFunc.openUI(\"uiExit\");\r\n    },\r\n\r\n    leaveRoom(data) {\r\n        if (Game.GameManager.gameState !== GameState.Over) {\r\n            uiFunc.openUI(\"uiTip\", function (obj) {\r\n                var uiTip = obj.getComponent(\"uiTip\");\r\n                if (uiTip) {\r\n                    uiTip.setData(\"对手离开了游戏\");\r\n                }\r\n            }.bind(this));\r\n        }\r\n    },\r\n\r\n\r\n    gameOver: function () {\r\n        //this.nodeDict['gameOver'].getComponent(cc.Animation).play();\r\n        //this.nodeDict['gameOver'].getComponent(cc.AudioSource).play();\r\n        this.complete.getComponent(\"bar_cosine\").checkProcess();\r\n        this.playerlists1[0].spriteFrame = this.players[GLB.good[0]].userIcon.spriteFrame;\r\n        this.playerlists1[1].spriteFrame = this.players[GLB.good[1]].userIcon.spriteFrame;\r\n        this.playerlists1[2].spriteFrame = this.players[GLB.good[2]].userIcon.spriteFrame;\r\n\r\n        this.playerlists1[3].spriteFrame = this.players[GLB.good[0]].userIcon.spriteFrame;\r\n        this.playerlists1[4].spriteFrame = this.players[GLB.good[1]].userIcon.spriteFrame;\r\n        this.playerlists1[5].spriteFrame = this.players[GLB.good[2]].userIcon.spriteFrame;\r\n\r\n\r\n        this.playerlists2[0].spriteFrame = this.players[GLB.bad[0]].userIcon.spriteFrame;;\r\n        this.playerlists2[1].spriteFrame = this.players[GLB.bad[1]].userIcon.spriteFrame;;\r\n\r\n        this.playerlists2[2].spriteFrame = this.players[GLB.bad[0]].userIcon.spriteFrame;;\r\n        this.playerlists2[3].spriteFrame = this.players[GLB.bad[1]].userIcon.spriteFrame;;\r\n\r\n        if (this.complete.getComponent(cc.ProgressBar).progress >= 60.0) {\r\n            this.gameRes.active = true;\r\n            this.gameRes.children[1].active =false;\r\n        } else {\r\n            this.gameRes.active = true;\r\n            this.gameRes.children[0].active =false;\r\n        }\r\n\r\n    },\r\n    end(){\r\n        cc.director.loadScene(\"start_scene\");\r\n    },\r\n\r\n    roundStart: function () {\r\n\r\n\r\n    },\r\n\r\n\r\n    currentPlayer() {\r\n        if (this.cd != null && this.cd) {\r\n            return;\r\n        }\r\n        this.cd = true;\r\n        setTimeout(() => {\r\n            this.cd = false;\r\n        }, 1000);\r\n\r\n        if (Game.GameManager.gameState == GameState.Play) {\r\n            this.players.forEach(player => {\r\n                player.setNormal();\r\n            });\r\n            if (GLB.nowPlayer != -1) {\r\n                this.players[GLB.nowPlayer].setBig();\r\n            }\r\n        }\r\n\r\n    },\r\n\r\n    onDestroy() {\r\n\r\n        clientEvent.off(clientEvent.eventType.leaveRoomMedNotify, this.leaveRoom, this);\r\n        clientEvent.off(clientEvent.eventType.roundStart, this.roundStart, this);\r\n        clientEvent.off(clientEvent.eventType.gameOver, this.gameOver, this);\r\n        clientEvent.off(clientEvent.eventType.roundVote, this.voteStart, this);\r\n        clientEvent.off(clientEvent.eventType.endVote, this.voteEnd, this);\r\n        clientEvent.off(clientEvent.eventType.writeVote, this.writeVote, this);\r\n    }\r\n});\r\n"]}