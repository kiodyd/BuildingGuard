{"version":3,"sources":["..\\..\\..\\..\\..\\..\\assets\\scripts\\common\\script/assets\\scripts\\common\\script\\uiLobbyPanel.js"],"names":["uiPanel","require","mvs","cc","Class","extends","properties","start","nodeDict","on","createRoom","joinRoom","exit","getComponent","Label","string","GLB","userInfo","id","Game","GameManager","nickName","avatarUrl","loader","load","url","type","err","texture","spriteFrame","SpriteFrame","Rect","width","height","Sprite","bind","network","isConnected","connect","IP","PORT","send","engine","logout","uiFunc","closeUI","node","name","destroy","onEnable","isRoomOwner","MAX_PLAYER_COUNT","Canvas","instance","designResolution","openUI","inviteFriend","window","wx","shareAppMessage","imageUrl"],"mappings":"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","file":"uiLobbyPanel.js","sourceRoot":"..\\..\\..\\..\\..\\..\\assets\\scripts\\common\\script","sourcesContent":["var uiPanel = require(\"uiPanel\");\r\nvar mvs = require(\"Matchvs\");\r\ncc.Class({\r\n    extends: uiPanel,\r\n\r\n    properties: {},\r\n\r\n    start() {\r\n        this.nodeDict[\"createRoom\"].on(\"click\", this.createRoom, this);\r\n        this.nodeDict[\"joinRoom\"].on(\"click\", this.joinRoom, this);\r\n        //this.nodeDict[\"inviteFriend\"].on(\"click\", this.inviteFriend, this);\r\n        this.nodeDict[\"exit\"].on(\"click\", this.exit, this);\r\n        this.nodeDict[\"name\"].getComponent(cc.Label).string = GLB.userInfo.id;\r\n        //this.nodeDict[\"rank\"].on(\"click\", this.rank, this);\r\n        if (Game.GameManager.nickName) {\r\n            this.nodeDict[\"name\"].getComponent(cc.Label).string = Game.GameManager.nickName;\r\n        } else {\r\n            this.nodeDict[\"name\"].getComponent(cc.Label).string = GLB.userInfo.id;\r\n        }\r\n        if (Game.GameManager.avatarUrl) {\r\n            cc.loader.load({url: Game.GameManager.avatarUrl, type: 'png'}, function(err, texture) {\r\n                var spriteFrame = new cc.SpriteFrame(texture, cc.Rect(0, 0, texture.width, texture.height));\r\n                this.nodeDict[\"userIcon\"].getComponent(cc.Sprite).spriteFrame = spriteFrame;\r\n            }.bind(this));\r\n        }\r\n        if (!Game.GameManager.network.isConnected()) {\r\n            Game.GameManager.network.connect(GLB.IP, GLB.PORT, function() {\r\n                Game.GameManager.network.send(\"connector.entryHandler.login\", {\r\n                    \"account\": GLB.userInfo.id + \"\",\r\n                    \"channel\": \"0\",\r\n                    \"userName\": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + \"\",\r\n                    \"headIcon\": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : \"-\"\r\n                });\r\n            });\r\n        }\r\n    },\r\n\r\n    // rank: function() {\r\n    //     Game.GameManager.blockInput();\r\n\r\n    //     if (!Game.GameManager.network.isConnected()) {\r\n    //         Game.GameManager.network.connect(GLB.IP, GLB.PORT, function() {\r\n    //                 Game.GameManager.network.send(\"connector.entryHandler.login\", {\r\n    //                     \"account\": GLB.userInfo.id + \"\",\r\n    //                     \"channel\": \"0\",\r\n    //                     \"userName\": Game.GameManager.nickName ? Game.GameManager.nickName : GLB.userInfo.id + \"\",\r\n    //                     \"headIcon\": Game.GameManager.avatarUrl ? Game.GameManager.avatarUrl : \"-\"\r\n    //                 });\r\n    //                 setTimeout(function() {\r\n    //                     Game.GameManager.network.send(\"connector.rankHandler.getRankData\", {\r\n    //                         \"account\": GLB.userInfo.id + \"\",\r\n    //                         \"game\": GLB.GAME_NAME\r\n    //                     });\r\n    //                 }, 500);\r\n    //             }\r\n    //         );\r\n    //     } else {\r\n    //         Game.GameManager.network.send(\"connector.rankHandler.getRankData\", {\r\n    //             \"account\": GLB.userInfo.id + \"\",\r\n    //             \"game\": GLB.GAME_NAME\r\n    //         });\r\n    //     }\r\n    // },\r\n\r\n    exit: function() {\r\n        mvs.engine.logout(\"\");\r\n        uiFunc.closeUI(this.node.name);\r\n        this.node.destroy();\r\n    },\r\n\r\n    onEnable() {\r\n        GLB.isRoomOwner = false;\r\n        GLB.MAX_PLAYER_COUNT = 2;\r\n    },\r\n\r\n    // randomRoom: function() {\r\n    //     Game.GameManager.blockInput();\r\n\r\n    //     GLB.matchType = GLB.RANDOM_MATCH; // 修改匹配方式为随机匹配\r\n    //     console.log('开始随机匹配');\r\n    //     if (GLB.gameType === GLB.COOPERATION) {\r\n    //         if (GLB.MAX_PLAYER_COUNT > 1) {\r\n    //             if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\r\n    //                 uiFunc.openUI(\"uiMatchingVer\", function(obj) {\r\n    //                     var matching = obj.getComponent(\"uiMatching\");\r\n    //                     matching.joinRandomRoom();\r\n    //                 });\r\n    //             } else {\r\n    //                 uiFunc.openUI(\"uiMatching\", function(obj) {\r\n    //                     var matching = obj.getComponent(\"uiMatching\");\r\n    //                     matching.joinRandomRoom();\r\n    //                 });\r\n    //             }\r\n    //         } else {\r\n    //             cc.director.loadScene('game');\r\n    //         }\r\n    //     } else if (GLB.gameType === GLB.COMPETITION) {\r\n    //         if (GLB.MAX_PLAYER_COUNT === 2) {\r\n    //             if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\r\n    //                 uiFunc.openUI(\"uiMatching1v1Ver\", function(obj) {\r\n    //                     var matching = obj.getComponent(\"uiMatching1v1Ver\");\r\n    //                     matching.joinRandomRoom();\r\n    //                 });\r\n    //             } else {\r\n    //                 uiFunc.openUI(\"uiMatching1v1\", function(obj) {\r\n    //                     var matching = obj.getComponent(\"uiMatching1v1\");\r\n    //                     matching.joinRandomRoom();\r\n    //                 });\r\n    //             }\r\n    //         } else if (GLB.MAX_PLAYER_COUNT === 4) {\r\n    //             if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\r\n    //                 uiFunc.openUI(\"uiMatching2v2Ver\", function(obj) {\r\n    //                     var matching = obj.getComponent(\"uiMatching2v2Ver\");\r\n    //                     matching.joinRandomRoom();\r\n    //                 });\r\n    //             } else {\r\n    //                 uiFunc.openUI(\"uiMatching2v2Ver\", function(obj) {\r\n    //                     var matching = obj.getComponent(\"uiMatching2v2Ver\");\r\n    //                     matching.joinRandomRoom();\r\n    //                 });\r\n    //             }\r\n    //         }\r\n    //     }\r\n    // },\r\n\r\n    createRoom: function() {\r\n        if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\r\n            uiFunc.openUI(\"uiCreateRoomVer\");\r\n        } else {\r\n            uiFunc.openUI(\"uiCreateRoom\");\r\n        }\r\n    },\r\n\r\n    joinRoom: function() {\r\n        if (cc.Canvas.instance.designResolution.height > cc.Canvas.instance.designResolution.width) {\r\n            uiFunc.openUI(\"uiRoomListVer\");\r\n        } else {\r\n            uiFunc.openUI(\"uiRoomList\");\r\n        }\r\n    },\r\n\r\n    inviteFriend: function() {\r\n        if (window.wx) {\r\n            wx.shareAppMessage({imageUrl: \"https://data.tianziyou.com/matchvsGamesRes/logo/basketballLogo1.png\"});\r\n        }\r\n    }\r\n});\r\n"]}