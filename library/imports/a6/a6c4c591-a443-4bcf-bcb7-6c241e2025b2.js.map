{"version":3,"sources":["..\\..\\..\\..\\..\\assets\\scripts\\game/assets\\scripts\\game\\StateSystem.js"],"names":["mvs","require","StateMachine","mainFsm","init","transitions","name","from","to","methods","onToRoundOne","Game","GameManager","gameState","GameState","Play","GLB","isRoomOwner","engine","sendEventEx","JSON","stringify","action","ROUND_STATE","state","RoundState","RoundOne","playerUserIds","GameEnv","outPlayers","includes","playerFsm","endToPlayerFour","endToPlayerThree","endToPlayerTwo","endToPlayerOne","onToRoundTwo","RoundTwo","onToVoteOne","RoundVote","setTimeout","checkResult","outs","attentions","voteNums","i","length","attentionPlayers","a","VOTE_END","toRoundThree","onToRoundThree","RoundThree","onToVoteTwo","toRoundFour","onToRoundFour","RoundFour","onToVoteThree","toRoundFive","onToRoundFive","RoundFive","onToEnd","good","bad","forEach","element","RoundEnd","onEndToPlayerOne","NOW_PLAYER","playerId","number","BlockManager","sendUpdateBMsg","onEndToPlayerTwo","onEndToPlayerThree","onEndToPlayerFour","onOneToPlayerTwo","onOneToPlayerThree","onOneToPlayerFour","onOneToPlayerFive","onTwoToPlayerThree","onTwoToPlayerFour","onTwoToPlayerFive","onTwoToPlayerEnd","is","toRoundTwo","toVoteOne","toVoteTwo","toVoteThree","toEnd","onThreeToPlayerFour","onThreeToPlayerFive","onThreeToPlayerEnd","onFourToPlayerFive","onFourToPlayerEnd","onFiveToPlayerEnd","module","exports"],"mappings":"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","file":"StateSystem.js","sourceRoot":"..\\..\\..\\..\\..\\assets\\scripts\\game","sourcesContent":["var mvs = require(\"Matchvs\");\r\nvar StateMachine = require(\"state-machine.min\");\r\nvar mainFsm = new StateMachine({\r\n    init: 'state_start',\r\n    transitions: [\r\n        { name: 'toRoundOne', from: 'state_start', to: 'state_round_one' },\r\n        { name: 'toRoundTwo', from: 'state_round_one', to: 'state_round_two' },\r\n        { name: 'toVoteOne', from: 'state_round_two', to: 'state_vote_one' },\r\n        { name: 'toRoundThree', from: 'state_vote_one', to: 'state_round_three' },\r\n        { name: 'toVoteTwo', from: 'state_round_three', to: 'state_vote_two' },\r\n        { name: 'toRoundFour', from: 'state_vote_two', to: 'state_round_four' },\r\n        { name: 'toVoteThree', from: 'state_round_four', to: 'state_vote_three' },\r\n        { name: 'toRoundFive', from: 'state_vote_three', to: 'state_round_five' },\r\n        { name: 'toEnd', from: 'state_round_five', to: 'state_end' }\r\n    ],\r\n    methods: {\r\n        onToRoundOne() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundOne\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n            \r\n            if(Game.GameEnv.outPlayers.includes(\"p1\")){\r\n                if(Game.GameEnv.outPlayers.includes(\"p2\")){\r\n                    if(Game.GameEnv.outPlayers.includes(\"p3\")){\r\n                        \r\n                        playerFsm.endToPlayerFour();\r\n                        \r\n                    }else{\r\n\r\n                        playerFsm.endToPlayerThree();\r\n                    }\r\n                }else{\r\n\r\n                    playerFsm.endToPlayerTwo();\r\n                }\r\n            }else{\r\n\r\n                playerFsm.endToPlayerOne();\r\n            }\r\n        },\r\n        onToRoundTwo() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundTwo\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n            if(Game.GameEnv.outPlayers.includes(\"p1\")){\r\n                if(Game.GameEnv.outPlayers.includes(\"p2\")){\r\n                    if(Game.GameEnv.outPlayers.includes(\"p3\")){\r\n                        \r\n                        playerFsm.endToPlayerFour();\r\n                        \r\n                    }else{\r\n\r\n                        playerFsm.endToPlayerThree();\r\n                    }\r\n                }else{\r\n\r\n                    playerFsm.endToPlayerTwo();\r\n                }\r\n            }else{\r\n\r\n                playerFsm.endToPlayerOne();\r\n            }\r\n        },\r\n        onToVoteOne() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundVote\r\n                }), 0, GLB.playerUserIds);\r\n\r\n                setTimeout(function () {\r\n\r\n                    Game.GameEnv.checkResult();\r\n                    let outs = \"\",attentions = \"\",voteNums = \"\";\r\n                    for (let i = 0; i < Game.GameEnv.outPlayers.length; i++) {\r\n                        outs += (Game.GameEnv.outPlayers[i] + \",\");\r\n                    }\r\n                    for (let i = 0; i < Game.GameEnv.attentionPlayers.length; i++) {\r\n                        attentions += (Game.GameEnv.attentionPlayers[i] + \",\");\r\n                    }\r\n                    for (let i = 1; i < 6; i++) {\r\n                        let a = \"p\" + i;\r\n                        voteNums += (Game.GameEnv.voteNums[a] + \",\");\r\n                    }\r\n                    mvs.engine.sendEventEx(0, JSON.stringify({\r\n                        action: GLB.VOTE_END,\r\n                        outs: outs,\r\n                        attentions: attentions,\r\n                        voteNums:voteNums,\r\n                    }), 0, GLB.playerUserIds);\r\n                }, 6000);\r\n            }\r\n            setTimeout(() => { mainFsm.toRoundThree() }, 10000);\r\n        },\r\n\r\n        onToRoundThree() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundThree\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n            if(Game.GameEnv.outPlayers.includes(\"p1\")){\r\n                if(Game.GameEnv.outPlayers.includes(\"p2\")){\r\n                    if(Game.GameEnv.outPlayers.includes(\"p3\")){\r\n                        \r\n                        playerFsm.endToPlayerFour();\r\n                        \r\n                    }else{\r\n\r\n                        playerFsm.endToPlayerThree();\r\n                    }\r\n                }else{\r\n\r\n                    playerFsm.endToPlayerTwo();\r\n                }\r\n            }else{\r\n\r\n                playerFsm.endToPlayerOne();\r\n            }\r\n        },\r\n        onToVoteTwo() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundVote\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n\r\n            setTimeout(function () {\r\n                Game.GameEnv.checkResult();\r\n                let outs = \"\",attentions = \"\",voteNums = \"\";\r\n                for (let i = 0; i < Game.GameEnv.outPlayers.length; i++) {\r\n                    outs += (Game.GameEnv.outPlayers[i] + \",\");\r\n                }\r\n                for (let i = 0; i < Game.GameEnv.attentionPlayers.length; i++) {\r\n                    attentions += (Game.GameEnv.attentionPlayers[i] + \",\");\r\n                }\r\n                for (let i = 1; i < 6; i++) {\r\n                    let a = \"p\" + i;\r\n                    voteNums += (Game.GameEnv.voteNums[a] + \",\");\r\n                }\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.VOTE_END,\r\n                    outs: outs,\r\n                    attentions: attentions,\r\n                    voteNums:voteNums,\r\n                }), 0, GLB.playerUserIds);\r\n            }, 6000);\r\n\r\n            setTimeout(() => { mainFsm.toRoundFour() }, 10000);\r\n        },\r\n\r\n        onToRoundFour() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundFour\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n            if(Game.GameEnv.outPlayers.includes(\"p1\")){\r\n                if(Game.GameEnv.outPlayers.includes(\"p2\")){\r\n                    if(Game.GameEnv.outPlayers.includes(\"p3\")){\r\n                        \r\n                        playerFsm.endToPlayerFour();\r\n                        \r\n                    }else{\r\n\r\n                        playerFsm.endToPlayerThree();\r\n                    }\r\n                }else{\r\n\r\n                    playerFsm.endToPlayerTwo();\r\n                }\r\n            }else{\r\n\r\n                playerFsm.endToPlayerOne();\r\n            }\r\n        },\r\n        onToVoteThree() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundVote\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n\r\n            setTimeout(function () {\r\n                Game.GameEnv.checkResult();\r\n                let outs = \"\",attentions = \"\",voteNums = \"\";\r\n                for (let i = 0; i < Game.GameEnv.outPlayers.length; i++) {\r\n                    outs += (Game.GameEnv.outPlayers[i] + \",\");\r\n                }\r\n                for (let i = 0; i < Game.GameEnv.attentionPlayers.length; i++) {\r\n                    attentions += (Game.GameEnv.attentionPlayers[i] + \",\");\r\n                }\r\n                for (let i = 1; i < 6; i++) {\r\n                    let a = \"p\" + i;\r\n                    voteNums += (Game.GameEnv.voteNums[a] + \",\");\r\n                }\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.VOTE_END,\r\n                    outs: outs,\r\n                    attentions: attentions,\r\n                    voteNums:voteNums\r\n                }), 0, GLB.playerUserIds);\r\n            }, 6000);\r\n\r\n            setTimeout(() => { mainFsm.toRoundFive() }, 10000);\r\n        },\r\n\r\n        onToRoundFive() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundFive\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n            if(Game.GameEnv.outPlayers.includes(\"p1\")){\r\n                if(Game.GameEnv.outPlayers.includes(\"p2\")){\r\n                    if(Game.GameEnv.outPlayers.includes(\"p3\")){\r\n                        \r\n                        playerFsm.endToPlayerFour();\r\n                        \r\n                    }else{\r\n\r\n                        playerFsm.endToPlayerThree();\r\n                    }\r\n                }else{\r\n\r\n                    playerFsm.endToPlayerTwo();\r\n                }\r\n            }else{\r\n\r\n                playerFsm.endToPlayerOne();\r\n            }\r\n        },\r\n        onToEnd() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                var good = \"\",bad = \"\";\r\n                GLB.good.forEach(element => {\r\n                    good += (element + \",\");\r\n                });\r\n\r\n                GLB.bad.forEach(element => {\r\n                    bad += (element + \",\");\r\n                });\r\n\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.ROUND_STATE,\r\n                    state: RoundState.RoundEnd,\r\n                    good:good,\r\n                    bad:bad\r\n                }), 0, GLB.playerUserIds);\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\nvar playerFsm = new StateMachine({\r\n    init: 'turn_end',\r\n    transitions: [\r\n\r\n        { name: 'endToPlayerOne', from: 'turn_end', to: 'state_player_one' },\r\n        { name: 'endToPlayerTwo', from: 'turn_end', to: 'state_player_two' },\r\n        { name: 'endToPlayerThree', from: 'turn_end', to: 'state_player_three' },\r\n        { name: 'endToPlayerFour', from: 'turn_end', to: 'state_player_four' },\r\n\r\n        { name: 'oneToPlayerTwo', from: 'state_player_one', to: 'state_player_two' },\r\n        { name: 'oneToPlayerThree', from: 'state_player_one', to: 'state_player_three' },\r\n        { name: 'oneToPlayerFour', from: 'state_player_one', to: 'state_player_four' },\r\n        { name: 'oneToPlayerFive', from: 'state_player_one', to: 'state_player_five' },\r\n\r\n        \r\n        { name: 'twoToPlayerThree', from: 'state_player_two', to: 'state_player_three' },\r\n        { name: 'twoToPlayerFour', from: 'state_player_two', to: 'state_player_four' },\r\n        { name: 'twoToPlayerFive', from: 'state_player_two', to: 'state_player_five' },\r\n        { name: 'twoToPlayerEnd', from: 'state_player_two', to: 'turn_end' },\r\n\r\n\r\n        { name: 'threeToPlayerFour', from: 'state_player_three', to: 'state_player_four' },\r\n        { name: 'threeToPlayerFive', from: 'state_player_three', to: 'state_player_five' },\r\n        { name: 'threeToPlayerEnd', from: 'state_player_three', to: 'turn_end' },\r\n\r\n        { name: 'fourToPlayerFive', from: 'state_player_four', to: 'state_player_five' },\r\n        { name: 'fourToPlayerEnd', from: 'state_player_four', to: 'turn_end' },\r\n\r\n        \r\n        { name: 'fiveToPlayerEnd', from: 'state_player_five', to: 'turn_end' },\r\n\r\n    ],\r\n    methods: {\r\n        onEndToPlayerOne() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[0],\r\n                    number: 0\r\n                }), 0, GLB.playerUserIds);\r\n\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n                \r\n            }\r\n\r\n            \r\n            //setTimeout(() => { playerFsm.toPlayerTwo() }, 2000);\r\n        },\r\n        onEndToPlayerTwo() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[1],\r\n                    number: 1\r\n                }), 0, GLB.playerUserIds);\r\n\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n                \r\n            }\r\n\r\n            \r\n            //setTimeout(() => { playerFsm.toPlayerTwo() }, 2000);\r\n        },\r\n        onEndToPlayerThree() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[2],\r\n                    number: 2\r\n                }), 0, GLB.playerUserIds);\r\n\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n                \r\n            }\r\n\r\n            \r\n            //setTimeout(() => { playerFsm.toPlayerTwo() }, 2000);\r\n        },\r\n        onEndToPlayerFour() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[3],\r\n                    number: 3\r\n                }), 0, GLB.playerUserIds);\r\n\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n                \r\n            }\r\n\r\n            \r\n            //setTimeout(() => { playerFsm.toPlayerTwo() }, 2000);\r\n        },\r\n\r\n\r\n\r\n        onOneToPlayerTwo() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[1],\r\n                    number: 1\r\n                }), 0, GLB.playerUserIds);\r\n\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toPlayerThree() }, 2000);\r\n        },\r\n        onOneToPlayerThree() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[2],\r\n                    number: 2\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toPlayerFour() }, 2000);\r\n        },\r\n        onOneToPlayerFour() {\r\n\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[3],\r\n                    number: 3\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toPlayerFive() }, 2000);\r\n        },\r\n        onOneToPlayerFive() {\r\n\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[4],\r\n                    number: 4\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toTurnEnd() }, 2000);\r\n        },\r\n\r\n\r\n\r\n\r\n\r\n\r\n        onTwoToPlayerThree() {\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[2],\r\n                    number: 2\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toPlayerFour() }, 2000);\r\n        },\r\n        onTwoToPlayerFour() {\r\n\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[3],\r\n                    number: 3\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toPlayerFive() }, 2000);\r\n        },\r\n        onTwoToPlayerFive() {\r\n\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[4],\r\n                    number: 4\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toTurnEnd() }, 2000);\r\n        },\r\n\r\n        onTwoToPlayerEnd() {\r\n\r\n            if (mainFsm.is('state_round_one')) {\r\n                setTimeout(() => { mainFsm.toRoundTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_two')) {\r\n                setTimeout(() => { mainFsm.toVoteOne() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_three')) {\r\n                setTimeout(() => { mainFsm.toVoteTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_four')) {\r\n                setTimeout(() => { mainFsm.toVoteThree() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_five')) {\r\n                setTimeout(() => { mainFsm.toEnd() }, 2000);\r\n            }\r\n\r\n        },\r\n\r\n\r\n        onThreeToPlayerFour() {\r\n\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[3],\r\n                    number: 3\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toPlayerFive() }, 2000);\r\n        },\r\n        onThreeToPlayerFive() {\r\n\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[4],\r\n                    number: 4\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toTurnEnd() }, 2000);\r\n        },\r\n\r\n        onThreeToPlayerEnd() {\r\n\r\n            if (mainFsm.is('state_round_one')) {\r\n                setTimeout(() => { mainFsm.toRoundTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_two')) {\r\n                setTimeout(() => { mainFsm.toVoteOne() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_three')) {\r\n                setTimeout(() => { mainFsm.toVoteTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_four')) {\r\n                setTimeout(() => { mainFsm.toVoteThree() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_five')) {\r\n                setTimeout(() => { mainFsm.toEnd() }, 2000);\r\n            }\r\n\r\n        },\r\n\r\n\r\n        onFourToPlayerFive() {\r\n\r\n            if (Game.GameManager.gameState === GameState.Play && GLB.isRoomOwner) {\r\n                mvs.engine.sendEventEx(0, JSON.stringify({\r\n                    action: GLB.NOW_PLAYER,\r\n                    playerId: GLB.playerUserIds[4],\r\n                    number: 4\r\n                }), 0, GLB.playerUserIds);\r\n                setTimeout(()=>{Game.BlockManager.sendUpdateBMsg();},500);\r\n            }\r\n            //setTimeout(() => { playerFsm.toTurnEnd() }, 2000);\r\n        },\r\n\r\n        onFourToPlayerEnd() {\r\n\r\n            if (mainFsm.is('state_round_one')) {\r\n                setTimeout(() => { mainFsm.toRoundTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_two')) {\r\n                setTimeout(() => { mainFsm.toVoteOne() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_three')) {\r\n                setTimeout(() => { mainFsm.toVoteTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_four')) {\r\n                setTimeout(() => { mainFsm.toVoteThree() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_five')) {\r\n                setTimeout(() => { mainFsm.toEnd() }, 2000);\r\n            }\r\n\r\n        },\r\n\r\n        onFiveToPlayerEnd() {\r\n\r\n            if (mainFsm.is('state_round_one')) {\r\n                setTimeout(() => { mainFsm.toRoundTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_two')) {\r\n                setTimeout(() => { mainFsm.toVoteOne() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_three')) {\r\n                setTimeout(() => { mainFsm.toVoteTwo() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_four')) {\r\n                setTimeout(() => { mainFsm.toVoteThree() }, 2000);\r\n            }\r\n            if (mainFsm.is('state_round_five')) {\r\n                setTimeout(() => { mainFsm.toEnd() }, 2000);\r\n            }\r\n\r\n        },\r\n\r\n    }\r\n});\r\n\r\n\r\nmodule.exports = {\r\n    mainFsm: mainFsm,\r\n    playerFsm: playerFsm\r\n};\r\n"]}